
# this method returns a value for sigma.
# it was found by searching for the largest sigma that could be used in exact_dpp_sampling.new_main(...) such that 
# 200 samples could be drawn without K^{-1} ever having condition number > 10**6, for small k, then 
# for larger k regression was used to predict.
# true values were found using exact_dpp_sampling.many_samples_search_sigma()
def get_sigma(n,d):
    d_to_n_to_sigma = {1:{3:46.65074,
                          4:2.94083,
                          5:0.93704,
                          6:0.52894,
                          7:0.36127,
                          8:0.29857,
                          9:0.24675,
                          10:0.18539,
                          11:0.16853,
                          12:0.13929,
                          13:0.12662,
                          14:0.10465,
                          15:0.10465,
                          16:0.09513,
                          17:0.09513,
                          18:0.07862,
                          19:0.07862,
                          20:0.07862,
                          22:0.06498,
                          23:0.05907,
                          26:0.0537,
                          27:0.04939318816202631,
                          29:0.04035,
                          33:0.03937168555428227,
                          39:0.032916833273904315,
                          42:0.03059280708704089,
                          47:0.02720481704452813,
                          48:0.02675430928307223,
                          54:0.02277,
                          57:0.022552035311887948,
                          61:0.021269259462959964,
                          69:0.018890803681999524,
                          78:0.01703770528141787,
                          83:0.016035890025853844,
                          88:0.015350010194996818,
                          100:0.013685890281750468,
                      },
                    2:{3:90.90909,
                       4:35.04939,
                       5:4.30568,
                       6:2.94083,
                       7:1.66002,
                       8:1.2472,
                       9:1.13382,
                       10:0.93704,
                       11:0.93704,
                       12:0.64001,
                       13:0.70401,
                       14:0.64001,
                       15:0.58183,
                       16:0.52894,
                       17:0.52894,
                       18:0.43714,
                       19:0.48085,
                       20:0.4146330743098223,
                       22:0.32843,
                       23:0.35880041831994347,
                       26:0.32843,
                       27:0.3076618771957846,
                       29:0.28615797510540997,
                       33:0.25545655969015624,
                       38:0.2240006596036348,
                       39:0.22057107394790731,
                       42:0.20552346903971766,
                       47:0.1886578504276379,
                       48:0.18386880760037003,
                       54:0.16719457995753156,
                       57:0.16176225535242436,
                       61:0.1519711005685888,
                       69:0.13989101817261326,
                       78:0.12640216910692265,
                       83:0.12230393001705188,
                       88:0.11591327570594066,
                       100:0.10740082901934361,
                   },
                       3:{3:100.0,
                          4:56.44739,
                          5:23.9392,
                          6:5.20987,
                          7:4.30568,
                          8:3.23492,
                          9:2.43044,
                          10:2.1745965606395807,
                          11:2.00863,
                          12:1.50911,
                          13:1.498466132080678,
                          14:1.2472,
                          15:1.2424414378527944,
                          16:1.145446929216046,
                          17:1.145186,
                          18:0.9922444117660543,
                          19:0.93704,
                          20:0.8769113004756699,
                          22:0.85186,
                          23:0.7492253393421292,
                          26:0.77441,
                          27:0.6307561585953244,
                          29:0.5857496739336988,
                          33:0.5143688467502399,
                          38:0.44873291378123165,
                          39:0.4378477475085649,
                          42:0.4086081604133392,
                          47:0.3688657801227756,
                          48:0.36198856486819914,
                          54:0.3264169095289727,
                          57:0.3115974758670837,
                          61:0.29421152639285786,
                          69:0.26569878982384815,
                          78:0.24077226884127803,
                          83:0.22928865119391598,
                          88:0.21911471278397016,
                          100:0.19882821844258847,
                      },
                       5:{3:100.0,
                          4:100.0,
                          5:68.30135,
                          6:35.04939,
                          7:14.86436,
                          8:6.30394,
                          9:5.73086,
                          10:5.593934257700913,
                          11:4.30568,
                          12:4.30568,
                          13:3.849541029694613,
                          14:3.23492,
                          15:3.189685233355076,
                          16:2.939821828232053,
                          17:2.67349,
                          18:2.545319905158005,
                          19:2.67349,
                          20:2.2484749231705035,
                          22:2.00863,
                          23:1.919999727955189,
                          26:1.82603,
                          27:1.615413440173145,
                          29:1.4997525943053402,
                          33:1.316379168871514,
                          38:1.147844051415454,
                          39:1.1199020970287759,
                          42:1.0448572347459195,
                          47:0.9428874249620244,
                          48:0.9252459353691685,
                          54:0.8340168346808596,
                          57:0.796020319668537,
                          61:0.7514515858975191,
                          69:0.6783800341621318,
                          78:0.6145219599269712,
                          83:0.5851104160358397,
                          88:0.5590575692610782,
                          100:0.5071221452816326,
                      }
                   }
    if d in d_to_n_to_sigma and n in d_to_n_to_sigma[d]:
        return d_to_n_to_sigma[d][n]
    else:
        return None
